(function(n){n.fn.examWizard=function(t){function r(){var t=n(i.markOption.markedQuestionsSelector).val();return JSON.parse(t)}function u(){return parseInt(n(i.currentQuestionSelector).val())}function it(){return u()-1}function rt(){return u()+1}function f(){return parseInt(n(i.totalOfQuestionSelector).val())}function p(t=false){return t?n("["+i.alternateNameAttr+"]").serializeArray():n(i.formSelector).serializeArray()}function e(t=false,r=true,u=false){var e=p(r),s,c,f,o,l,a,h;for(u&&(e=n('[name="'+u+'"]').serializeArray()),s={},c=0,f=0;f<e.length;f++)e[f].value&&(o=n("[name='"+e[f].name+"'][value='"+e[f].value.replace(/'/g,'"')+"']"),o.attr(i.alternateNameAttr)||(o=n("[name='"+e[f].name+"']")),o.attr(i.alternateTypeAttr)==="select"&&(l=o.find("option:selected"),l.each(function(){n(this).val()===e[f].value&&o.attr(i.alternateValueAttr,n(this).attr(i.alternateValueAttr))})),a=o.parents("[data-question]").data("question"),h={name:e[f].name,value:e[f].value,alternateName:o.attr(i.alternateNameAttr),alternateValue:o.attr(i.alternateValueAttr),currentQNumber:a},t?(s[e[f].name]||(s[e[f].name]={}),s[e[f].name][f]=h):s[c++]=h);return s}function s(t){i.markOption.enableMarked&&(n(i.markOption.markUnmarkWrapper).addClass("hidden"),n(i.markOption.markUnmarkWrapper+'[data-question="'+t+'"]').removeClass("hidden"))}function h(n=0){var t=i.markOption.markedLinkSelector.substr(1);return'<a href="javascript:void(0);" class="'+t+'" data-question="'+n+'">'+i.markOption.markedLabel+"<\/a>"}function w(){if(i.finishOption.enableAndDisableFinshBtn===!0){var t=f(),r=u();y(i.finishOption.enableFinishButtonAtQNum)&&(t=i.finishOption.enableFinishButtonAtQNum);r>=t?n(i.finishOption.finishBtnSelector).removeClass("disabled"):n(i.finishOption.finishBtnSelector).addClass("disabled")}}function c(t){n(i.currentQuestionLabel).html(t)}function ut(){var r=i.quickAccessOption.quickAccessPagerItem;if(i.quickAccessOption.quickAccessPagerItem!=="Full"&&y(r)){var e=f(),u=Math.ceil(e/r),t=n(i.quickAccessOption.quickAccessInfoSelector).attr("data-current-page");t||(t=1,n(i.quickAccessOption.quickAccessInfoSelector).attr("data-current-page",t));t==1?n(i.quickAccessOption.quickAccessPrevSelector).addClass("disabled"):t==u&&n(i.quickAccessOption.quickAccessNextSelector).addClass("disabled");k(t,u)}}function b(t){var r=n(i.quickAccessOption.quickAccessInfoSelector).attr("data-current-page"),e=f(),o=i.quickAccessOption.quickAccessPagerItem,u=Math.ceil(e/o);if(t==="Next"?r++:r--,r>=u?n(i.quickAccessOption.quickAccessNextSelector).addClass("disabled"):n(i.quickAccessOption.quickAccessNextSelector).removeClass("disabled"),r<=1?n(i.quickAccessOption.quickAccessPrevSelector).addClass("disabled"):n(i.quickAccessOption.quickAccessPrevSelector).removeClass("disabled"),r>u||r<1)return!1;n(i.quickAccessOption.quickAccessInfoSelector).attr("data-current-page",r);k(r,u)}function k(t,r,u=0){if(u!==0||(u=i.quickAccessOption.quickAccessPagerItem,i.quickAccessOption.quickAccessPagerItem!=="Full"&&y(u))){var f=n(i.quickAccessOption.quickAccessInfoSelector).attr("data-current-page");n(i.quickAccessOption.quickAccessSection+" [data-question]").hide();n(i.quickAccessOption.quickAccessSection+" [data-question]:nth-child(-n+"+u*f+")").show();f>1&&n(i.quickAccessOption.quickAccessSection+" [data-question]:nth-child(-n+"+u*(f-1)+")").hide();n(i.quickAccessOption.quickAccessInfoSelector).html(t+" "+i.quickAccessOption.quickAccessInfoSeperator+" "+r)}}function l(){var t=e(!0),r=a(t),u=n("["+i.alternateNameAttr+"]");u.each(function(){var t=n(this).attr("name"),i;r.indexOf(t)>-1||(i=n('[name="'+t+'"]').parents("[data-question]").data("question"),o(null,i))});i.markOption.enableMarked&&ft()}function o(t,r){t||(t=i.quickAccessOption.quickAccessDefaultRowVal);n(i.quickAccessOption.quickAccessRow+'[data-question="'+r+'"] '+i.quickAccessOption.quickAccessRowValue).html(t)}function a(t,u=true,f=false){var k=0,w=[],d=0,b=[],g=r(),a=!1,y,s,l,p;if(!n.isEmptyObject(t))for(y in t){if(t.hasOwnProperty(y)){var e=t[y],h=[],c=0;for(s in e)h[c]=e[s].alternateValue,w[k++]=e[s].name,l=e[s].currentQNumber,h[c]||(h[c]=e[s].value),c++}p=h.join(i.quickAccessOption.quickAccessRowValSeparator);b[d++]=p;i.markOption.enableMarked&&(a=g.indexOf(l)>-1);u&&!a?o(p,l):a&&v(l,2)}return f?b:w}function v(t,u){var p=n("["+i.alternateNameAttr+'="answer['+(t-1)+']"]'),s=e(!0,!0,p.attr("name")),c=h(t),l=n(i.quickAccessOption.quickAccessRow+'[data-question="'+t+'"] '+i.quickAccessOption.quickAccessRowValue),v=n(i.markOption.markSelector+'[data-question="'+t+'"]'),y=n(i.markOption.unmarkSelector+'[data-question="'+t+'"]'),f=r();u===0?(v.addClass("hidden"),y.removeClass("hidden"),f.push(t),n(i.markOption.markedQuestionsSelector).val(JSON.stringify(f)),l.html(c)):u===1?(v.removeClass("hidden"),y.addClass("hidden"),f.splice(f.indexOf(t),1),n(i.markOption.markedQuestionsSelector).val(JSON.stringify(f)),n.isEmptyObject(s)?o(null,t):a(s)):u===2&&l.html(c)}function ft(){var t=r();for(var f in t){var u=t[f],e=h(u),o=n(i.quickAccessOption.quickAccessRow+'[data-question="'+u+'"] '+i.quickAccessOption.quickAccessRowValue);o.html(e)}}function y(n){return/^\d+$/.test(n)}function d(n,t){var r,u;n+=i.cookiesOption.cookieKey;r=new Date;r.setTime(r.getTime()+i.cookiesOption.expires);u="expires="+r.toUTCString();document.cookie=n+"="+t.replace(/;/g,",")+"{sep};"+u+";path=/"}function et(n=true,t=""){var u,r,s;t+=i.cookiesOption.cookieKey;var f=t+"=",h=decodeURIComponent(document.cookie),e=h.split("{sep};"),o=[];for(u=0;u<e.length;u++){for(r=e[u];r.charAt(0)==" ";)r=r.substring(1);if((n||r.indexOf(f)==0)&&r.indexOf(i.cookiesOption.cookieKey)>-1)if(r=r.replace(i.cookiesOption.cookieKey,""),n)s=r.substr(0,r.indexOf("=")),o[s]=r.substring(r.indexOf("=")+1,r.length);else return r.substring(f.length,r.length)}return n?o:""}function ot(n){n+=i.cookiesOption.cookieKey;document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/"}function st(n){var r,i,e,o;for(r in n){var t=n[r],u=[],f=0;for(i in t)u[f]=t[i].value,e=t[i].name,f++;o=u.join("{sep}");d(e,o)}}function g(){var t=n(i.markOption.markedQuestionsSelector).val();d(i.markOption.markedQuestionsSelector,t)}function ht(){var h=et(),u,t,c,e,o,s,v,y;for(u in h){t=n("[name='"+u+"']");u==i.markOption.markedQuestionsSelector&&i.markOption.enableMarked&&(c=n(i.markOption.markedQuestionsSelector).attr("name"),t=n("[name='"+c+"']"));var f=h[u].split("{sep}"),a=[],p=0;for(e in f)f[e]!=""&&(a[p++]=f[e],t.data("alternatetype")==="checkbox"||t.data("alternatetype")==="radio"?n("[name='"+u+"'][value='"+f[e]+"']").prop("checked",!0):t.val(f[e]));t.data("alternatetype")==="select"&&t.val(a)}if(i.quickAccessOption.enableAccessSection&&l(),i.markOption.enableMarked){o=r();for(s in o)v=n(i.markOption.markSelector+'[data-question="'+o[s]+'"]'),y=n(i.markOption.unmarkSelector+'[data-question="'+o[s]+'"]'),v.addClass("hidden"),y.removeClass("hidden")}}function nt(){var n=e(!0,!0);return Object.keys(n).length}function ct(){var n=r();return Object.keys(n).length}function lt(){var n=f();return n-nt()}var tt={currentQuestionSelector:"#currentQuestionNumber",totalOfQuestionSelector:"#totalOfQuestion",formSelector:"#examwizard-question",currentQuestionLabel:"#current-question-number-label",alternateNameAttr:"data-alternateName",alternateValueAttr:"data-alternateValue",alternateTypeAttr:"data-alternateType",quickAccessOption:{quickAccessSection:"#quick-access-section",enableAccessSection:!0,quickAccessPagerItem:"Full",quickAccessInfoSelector:"#quick-access-info",quickAccessPrevSelector:"#quick-access-prev",quickAccessNextSelector:"#quick-access-next",quickAccessInfoSeperator:"/",quickAccessRow:".question-response-rows",quickAccessRowValue:".question-response-rows-value",quickAccessDefaultRowVal:"-",quickAccessRowValSeparator:", ",nextCallBack:function(){},prevCallBack:function(){}},nextOption:{nextSelector:"#go-to-next-question",allowadNext:!0,callBack:function(){},breakNext:function(){return!1}},prevOption:{prevSelector:"#back-to-prev-question",allowadPrev:!0,allowadPrevOnQNum:2,callBack:function(){},breakPrev:function(){return!1}},finishOption:{enableAndDisableFinshBtn:!0,enableFinishButtonAtQNum:"onLastQuestion",finishBtnSelector:"#finishExams",enableModal:!1,finishModalTarget:"#finishExamsModal",finishModalAnswerd:".finishExams-total-answerd",finishModalMarked:".finishExams-total-marked",finishModalRemaining:".finishExams-total-remaining",callBack:function(){}},markOption:{markSelector:".mark-question",unmarkSelector:".unmark-question",markedLinkSelector:".marked-link",markedQuestionsSelector:"#markedQuestion",markedLabel:"Marked",markUnmarkWrapper:".mark-unmark-wrapper",enableMarked:!0,markCallBack:function(){},unMarkCallBack:function(){}},cookiesOption:{enableCookie:!1,cookieKey:"",expires:864e5}},i=n.extend(!0,{},tt,t);n(document).on("click",i.nextOption.nextSelector,function(){var r=u(),t=rt(),e=f(),o=i.nextOption.breakNext();if(o)return 0;r<e&&i.nextOption.allowadNext&&(n(i.currentQuestionSelector).val(t),n(i.formSelector+' [data-question="'+r+'"]').addClass("hidden"),n(i.formSelector+' [data-question="'+t+'"]').removeClass("hidden"),c(t),i.prevOption.allowadPrev&&t>=i.prevOption.allowadPrevOnQNum&&n(i.prevOption.prevSelector).removeClass("disabled"),w(),s(t),i.nextOption.callBack());e!=t&&i.nextOption.allowadNext||n(i.nextOption.nextSelector).addClass("disabled")});n(document).on("click",i.prevOption.prevSelector,function(){var r=u(),t=it(),f=i.prevOption.breakPrev();if(f)return 0;r>1&&i.prevOption.allowadPrev&&(n(i.currentQuestionSelector).val(t),n(i.formSelector+' [data-question="'+r+'"]').addClass("hidden"),n(i.formSelector+' [data-question="'+t+'"]').removeClass("hidden"),c(t),i.nextOption.allowadNext&&n(i.nextOption.nextSelector).removeClass("disabled"),w(),s(t),i.prevOption.callBack());(t<=1||!i.prevOption.allowadPrev||t<i.prevOption.allowadPrevOnQNum)&&n(i.prevOption.prevSelector).addClass("disabled")});n(document).on("click",i.markOption.markSelector,function(){var t=n(this).data("question");v(t,0);g();i.markOption.markCallBack()});n(document).on("click",i.markOption.unmarkSelector,function(){var t=n(this).data("question");v(t,1);g();i.markOption.unMarkCallBack()});n(document).on("click",i.markOption.markedLinkSelector,function(){var t=n(this).data("question"),r=f();n(i.currentQuestionSelector).val(t);n(i.formSelector+" [data-question]").addClass("hidden");n(i.formSelector+' [data-question="'+t+'"]').removeClass("hidden");c(t);s(t);t<=1||!i.prevOption.allowadPrev||t<i.prevOption.allowadPrevOnQNum?n(i.prevOption.prevSelector).addClass("disabled"):n(i.prevOption.prevSelector).removeClass("disabled");r!=t&&i.nextOption.allowadNext?n(i.nextOption.nextSelector).removeClass("disabled"):n(i.nextOption.nextSelector).addClass("disabled")});n(document).on("click",i.quickAccessOption.quickAccessPrevSelector,function(){i.quickAccessOption.enableAccessSection&&(b("Prev"),l(),i.quickAccessOption.prevCallBack())});n(document).on("click",i.quickAccessOption.quickAccessNextSelector,function(){i.quickAccessOption.enableAccessSection&&(b("Next"),l(),i.quickAccessOption.nextCallBack())});n(document).on("change select keyup","["+i.alternateNameAttr+"]",function(){var t=u(),f=e(!0,!0,n(this).attr("name")),c=r(),s;n.isEmptyObject(f)?(s=null,i.markOption.enableMarked&&c.indexOf(t)>-1&&(s=h(t)),o(s,t),i.cookiesOption.enableCookie&&ot(n(this).attr("name"))):(a(f),i.cookiesOption.enableCookie&&st(f))});return i.quickAccessOption.enableAccessSection&&ut(),i.cookiesOption.enableCookie&&(n(i.currentQuestionSelector).val(1),ht()),{getMarkedQuestion:function(){return r()},getAnswerdValue:function(n=true,t=true){return e(n,t)},getTotalOfAnswerdValue:function(){return nt()},getTotalOfMarkedValue:function(){return ct()},getTotalOfRemainingValue:function(){return lt()},getCurrentQuestionNumber:function(){return u()},getAllFormData:function(){return p()}}}})(jQuery);